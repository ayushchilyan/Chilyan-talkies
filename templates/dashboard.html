<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body {
      background: linear-gradient(135deg, #ffdde1, #ee9ca7);
      min-height: 100vh;
      padding-top: 40px;
      font-family: Arial, sans-serif;
    }
    .card {
      border-radius: 18px;
      box-shadow: 0px 6px 20px rgba(0,0,0,0.1);
      margin-bottom: 25px;
      transition: transform 0.2s ease-in-out;
    }
    .card:hover {
      transform: translateY(-3px);
    }
    h2 {
      font-weight: bold;
      color: #333;
    }
    h4 {
      font-weight: 600;
      color: #444;
    }
    .btn {
      border-radius: 25px;
      padding: 8px 20px;
    }
    /* Balloons animation */
    .balloon {
      position: absolute;
      width: 60px;
      height: 80px;
      border-radius: 50%;
      bottom: -100px;
      animation: float 8s infinite ease-in;
    }
    @keyframes float {
      0% { transform: translateY(0); opacity: 1; }
      100% { transform: translateY(-100vh); opacity: 0; }
    }
  </style>
</head>
<body>
  <div class="container">

    <!-- Welcome -->
    <div class="text-center mb-5">
      <h2>🎉 Welcome, {{ username }} 🎉</h2>
      <p class="text-muted">Your personal birthday dashboard</p>
    </div>

    <!-- Navigation Buttons -->
    <div class="d-flex justify-content-center flex-wrap mb-4">
      <a href="{{ url_for('users_list') }}" class="btn btn-primary m-2">👥 Find Friends</a>
      <a href="{{ url_for('friend_requests') }}" class="btn btn-warning m-2">📩 Friend Requests</a>
      <a href="{{ url_for('friends_list') }}" class="btn btn-success m-2">✅ My Friends</a>
      <a href="{{ url_for('chat') }}" class="btn btn-info m-2">💬 Open Chat</a>
    </div>

    <!-- Note Message -->
    <div class="card p-4">
      <h4>💌 Your Birthday Note</h4>
      <form method="POST">
        <textarea name="note" rows="3" class="form-control mb-3">{{ note }}</textarea>
        <button type="submit" class="btn btn-primary">Save Note</button>
      </form>
    </div>

    <!-- Upload Photos -->
    <div class="card p-4">
      <h4>🖼️ Upload Photos</h4>
      <form method="POST" enctype="multipart/form-data" class="mb-3">
        <input type="file" name="photo_file" accept=".png,.jpg,.jpeg,.gif,.webp" class="form-control mb-2">
        <button type="submit" class="btn btn-success">Upload Photo</button>
      </form>
      <div class="d-flex flex-wrap gap-2">
        {% for p in photos %}
          <img src="{{ url_for('serve_upload', username=username, media='photos', filename=p['filename']) }}" width="120" class="rounded shadow">
        {% endfor %}
      </div>
    </div>

    <!-- Upload Videos -->
    <div class="card p-4">
      <h4>🎥 Upload Videos</h4>
      <form method="POST" enctype="multipart/form-data" class="mb-3">
        <input type="file" name="video_file" accept=".mp4,.mov,.m4v,.webm" class="form-control mb-2">
        <button type="submit" class="btn btn-warning">Upload Video</button>
      </form>
      <div class="d-flex flex-wrap gap-3">
        {% for v in videos %}
          <video width="200" controls>
            <source src="{{ url_for('serve_upload', username=username, media='videos', filename=v['filename']) }}">
          </video>
        {% endfor %}
      </div>
    </div>

    <!-- Upload Audios -->
    <div class="card p-4">
      <h4>🎶 Upload Audios</h4>
      <form method="POST" enctype="multipart/form-data" class="mb-3">
        <input type="file" name="audio_file" accept=".mp3,.wav,.m4a,.aac" class="form-control mb-2">
        <button type="submit" class="btn btn-info">Upload Audio</button>
      </form>
      <div>
        {% for a in audios %}
          <audio controls>
            <source src="{{ url_for('serve_upload', username=username, media='audios', filename=a['filename']) }}">
          </audio>
        {% endfor %}
      </div>
    </div>

    <!-- Celebration Balloons -->
    <div id="celebration"></div>
    <script>
      function createBalloon() {
        const balloon = document.createElement("div");
        balloon.className = "balloon";
        balloon.style.left = Math.random() * 100 + "vw";
        balloon.style.background = "hsl(" + Math.random() * 360 + ",70%,60%)";
        balloon.style.animationDuration = (5 + Math.random() * 5) + "s";
        document.getElementById("celebration").appendChild(balloon);
        setTimeout(() => { balloon.remove(); }, 8000);
      }
      setInterval(createBalloon, 400);
    </script>

    <!-- Share Link -->
    <div class="card p-4 text-center">
      <h4>🔗 Your Share Link</h4>
      <p><a href="{{ share_url }}" target="_blank">Share with your loved ones 💕</a></p>
      <a href="https://www.instagram.com/chilyanji/" target="_blank" class="btn btn-outline-dark btn-sm">📸 Follow Author</a>
      <a href="{{ url_for('logout') }}" class="btn btn-danger ms-2">🚪 Logout</a>
    </div>

  </div>
</body>
</html>
